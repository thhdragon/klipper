Starting Klippy...
Args: ['./klippy/klippy.py', '/app/test/klippy/delta_lean.cfg', '-i', './_test_.gcode', '-o', '_test_output', '-v', '-d', './klippy/chelper/atmega2560.dict', '-l', '/app/_test_.log']
Git version: '38e33ae'
Branch: (HEAD detached from cd17dc6)
Remote: ?
Tracked URL: ?
CPU: 4 core Intel(R) Xeon(R) Processor @ 2.30GHz
Python: '3.12.11 (main, Jul  9 2025, 00:50:55) [GCC 13.3.0]'
Building C code module c_helper.so
Start printer at Wed Jul 16 06:38:34 2025 (1752647914.9 3722.6)
===== Config file =====
[stepper_a]
step_pin = PF0
dir_pin = PF1
enable_pin = !PD7
microsteps = 16
rotation_distance = 0.32
endstop_pin = ^PE4
homing_speed = 50
position_endstop = 295.0
arm_length = 330.0
angle = 210
radial_lean = 1.0
tangential_lean = -0.5

[stepper_b]
step_pin = PF6
dir_pin = PF7
enable_pin = !PF2
microsteps = 16
rotation_distance = 0.32
endstop_pin = ^PJ0
angle = 330
radial_lean = -1.0
tangential_lean = 1.0

[stepper_c]
step_pin = PL3
dir_pin = PL1
enable_pin = !PK0
microsteps = 16
rotation_distance = 0.32
endstop_pin = ^PD2
angle = 90
radial_lean = 0.5
tangential_lean = -1.0

[mcu]
serial = /dev/ttyACM0

[printer]
kinematics = delta
max_velocity = 300
max_accel = 3000
delta_radius = 170.0

[delta_calibrate]
radius = 50
=======================
SciPy library not found, advanced delta calibration optimizer will be disabled if not installed.
Config option 'delta_effector_radius' not specified in [printer] section. Using default 40.00mm. For accurate probe tilt compensation, this value should be set.
Delta max build height 295.00mm (radius tapered above 247.84mm)
print_radius 170.00mm is larger than kinematically safe radius 158.86mm
Delta max build radius 158.86mm (moves slowed past 143.07mm and 155.51mm)
Loaded MCU 'mcu' 132 commands (9d7a351 / gcc: (GCC) 7.3.0 binutils: (GNU Binutils) 2.26.20160125)
MCU 'mcu' config: ADC_MAX=1023 BUS_PINS_spi=PB3,PB2,PB1 BUS_PINS_twi=PD0,PD1 CLOCK_FREQ=16000000 MCU=atmega2560 PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PE0,PE1 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_OPTIMIZED_UNSTEP=40 STEPPER_STEP_BOTH_EDGE=1
Sending MCU 'mcu' printer configuration...
Configured MCU 'mcu' (500 moves)
Running full garbage collection and freezing
Internal error on command:"G28"
Traceback (most recent call last):
  File "/app/klippy/gcode.py", line 212, in _process_commands
    handler(gcmd)
  File "/app/klippy/extras/homing.py", line 288, in cmd_G28
    kin.home(homing_state)
  File "/app/klippy/kinematics/delta.py", line 225, in home
    homing_state.home_rails(self.rails, forcepos, self.home_position)
  File "/app/klippy/extras/homing.py", line 201, in home_rails
    hmove.homing_move(homepos, hi.speed)
  File "/app/klippy/extras/homing.py", line 86, in homing_move
    self.stepper_positions = [ StepperPosition(s, name)
                               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/klippy/extras/homing.py", line 31, in __init__
    self.start_pos = stepper.get_mcu_position()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/klippy/stepper.py", line 170, in get_mcu_position
    return int(mcu_pos - 0.5)
           ^^^^^^^^^^^^^^^^^^
ValueError: cannot convert float NaN to integer
Transition to shutdown state: Internal error on command:"G28"
Dumping gcode input 1 blocks
Read 3722.729613: 'G28\nDELTA_CALIBRATE\n'
gcode state: absolute_coord=True absolute_extrude=True base_position=[0.0, 0.0, 0.0, 0.0] last_position=[-11.486506407542976, 4.1387278264288625, -433.8695293656721, 0.0] homing_position=[0.0, 0.0, 0.0, 0.0] speed_factor=0.016666666666666666 extrude_factor=1.0 speed=25.0
Reactor garbage collection: (0.0, 0.0, 0.0)
Internal error on command:"G28"
Once the underlying issue is corrected, use the
"FIRMWARE_RESTART" command to reset the firmware, reload the
config, and restart the host software.
Printer is shutdown

Internal error on command:"G28"
Internal error on command:"G28"
Once the underlying issue is corrected, use the
"FIRMWARE_RESTART" command to reset the firmware, reload the
config, and restart the host software.
Printer is shutdown

Unfreezing garbage collection
Starting Klippy...
Args: ['./klippy/klippy.py', '/app/test/klippy/delta_lean.cfg', '-i', './_test_.gcode', '-o', '_test_output', '-v', '-d', './klippy/chelper/atmega2560.dict', '-l', '/app/_test_.log']
Git version: '35b815c-dirty'
Modified files: _test_.log
Branch: (HEAD detached from cd17dc6)
Remote: ?
Tracked URL: ?
CPU: 4 core Intel(R) Xeon(R) Processor @ 2.30GHz
Python: '3.12.11 (main, Jul  9 2025, 00:50:55) [GCC 13.3.0]'
Building C code module c_helper.so
Start printer at Wed Jul 16 06:39:13 2025 (1752647953.7 3761.5)
===== Config file =====
[stepper_a]
step_pin = PF0
dir_pin = PF1
enable_pin = !PD7
microsteps = 16
rotation_distance = 0.32
endstop_pin = ^PE4
homing_speed = 50
position_endstop = 295.0
arm_length = 330.0
angle = 210
radial_lean = 1.0
tangential_lean = -0.5

[stepper_b]
step_pin = PF6
dir_pin = PF7
enable_pin = !PF2
microsteps = 16
rotation_distance = 0.32
endstop_pin = ^PJ0
angle = 330
radial_lean = -1.0
tangential_lean = 1.0

[stepper_c]
step_pin = PL3
dir_pin = PL1
enable_pin = !PK0
microsteps = 16
rotation_distance = 0.32
endstop_pin = ^PD2
angle = 90
radial_lean = 0.5
tangential_lean = -1.0

[mcu]
serial = /dev/ttyACM0

[printer]
kinematics = delta
max_velocity = 300
max_accel = 3000
delta_radius = 170.0

[delta_calibrate]
radius = 50
=======================
SciPy library not found, advanced delta calibration optimizer will be disabled if not installed.
Config option 'delta_effector_radius' not specified in [printer] section. Using default 40.00mm. For accurate probe tilt compensation, this value should be set.
Delta max build height 295.00mm (radius tapered above 247.84mm)
print_radius 170.00mm is larger than kinematically safe radius 158.86mm
Delta max build radius 158.86mm (moves slowed past 143.07mm and 155.51mm)
Loaded MCU 'mcu' 132 commands (9d7a351 / gcc: (GCC) 7.3.0 binutils: (GNU Binutils) 2.26.20160125)
MCU 'mcu' config: ADC_MAX=1023 BUS_PINS_spi=PB3,PB2,PB1 BUS_PINS_twi=PD0,PD1 CLOCK_FREQ=16000000 MCU=atmega2560 PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PE0,PE1 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_OPTIMIZED_UNSTEP=40 STEPPER_STEP_BOTH_EDGE=1
Sending MCU 'mcu' printer configuration...
Configured MCU 'mcu' (500 moves)
Running full garbage collection and freezing
Internal error on command:"G28"
Traceback (most recent call last):
  File "/app/klippy/gcode.py", line 212, in _process_commands
    handler(gcmd)
  File "/app/klippy/extras/homing.py", line 288, in cmd_G28
    kin.home(homing_state)
  File "/app/klippy/kinematics/delta.py", line 225, in home
    homing_state.home_rails(self.rails, forcepos, self.home_position)
  File "/app/klippy/extras/homing.py", line 201, in home_rails
    hmove.homing_move(homepos, hi.speed)
  File "/app/klippy/extras/homing.py", line 86, in homing_move
    self.stepper_positions = [ StepperPosition(s, name)
                               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/klippy/extras/homing.py", line 31, in __init__
    self.start_pos = stepper.get_mcu_position()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/klippy/stepper.py", line 170, in get_mcu_position
    return int(mcu_pos - 0.5)
           ^^^^^^^^^^^^^^^^^^
ValueError: cannot convert float NaN to integer
Transition to shutdown state: Internal error on command:"G28"
Dumping gcode input 1 blocks
Read 3761.565425: 'G28\nDELTA_CALIBRATE\n'
gcode state: absolute_coord=True absolute_extrude=True base_position=[0.0, 0.0, 0.0, 0.0] last_position=[-11.486506407542976, 4.1387278264288625, -433.8695293656721, 0.0] homing_position=[0.0, 0.0, 0.0, 0.0] speed_factor=0.016666666666666666 extrude_factor=1.0 speed=25.0
Reactor garbage collection: (0.0, 0.0, 0.0)
Internal error on command:"G28"
Once the underlying issue is corrected, use the
"FIRMWARE_RESTART" command to reset the firmware, reload the
config, and restart the host software.
Printer is shutdown

Internal error on command:"G28"
Internal error on command:"G28"
Once the underlying issue is corrected, use the
"FIRMWARE_RESTART" command to reset the firmware, reload the
config, and restart the host software.
Printer is shutdown

Unfreezing garbage collection
Starting Klippy...
Args: ['./klippy/klippy.py', '/app/test/klippy/delta_lean.cfg', '-i', './_test_.gcode', '-o', '_test_output', '-v', '-d', './klippy/chelper/atmega2560.dict', '-l', '/app/_test_.log']
Git version: 'eb2cf89-dirty'
Modified files: _test_.log
Branch: (HEAD detached from cd17dc6)
Remote: ?
Tracked URL: ?
CPU: 4 core Intel(R) Xeon(R) Processor @ 2.30GHz
Python: '3.12.11 (main, Jul  9 2025, 00:50:55) [GCC 13.3.0]'
Building C code module c_helper.so
Start printer at Wed Jul 16 06:39:31 2025 (1752647971.8 3779.5)
===== Config file =====
[stepper_a]
step_pin = PF0
dir_pin = PF1
enable_pin = !PD7
microsteps = 16
rotation_distance = 0.32
endstop_pin = ^PE4
homing_speed = 50
position_endstop = 295.0
arm_length = 330.0
angle = 210
radial_lean = 1.0
tangential_lean = -0.5

[stepper_b]
step_pin = PF6
dir_pin = PF7
enable_pin = !PF2
microsteps = 16
rotation_distance = 0.32
endstop_pin = ^PJ0
angle = 330
radial_lean = -1.0
tangential_lean = 1.0

[stepper_c]
step_pin = PL3
dir_pin = PL1
enable_pin = !PK0
microsteps = 16
rotation_distance = 0.32
endstop_pin = ^PD2
angle = 90
radial_lean = 0.5
tangential_lean = -1.0

[mcu]
serial = /dev/ttyACM0

[printer]
kinematics = delta
max_velocity = 300
max_accel = 3000
delta_radius = 170.0

[delta_calibrate]
radius = 50
=======================
SciPy library not found, advanced delta calibration optimizer will be disabled if not installed.
Config option 'delta_effector_radius' not specified in [printer] section. Using default 40.00mm. For accurate probe tilt compensation, this value should be set.
Delta max build height 295.00mm (radius tapered above 247.84mm)
print_radius 170.00mm is larger than kinematically safe radius 158.86mm
Delta max build radius 158.86mm (moves slowed past 143.07mm and 155.51mm)
Loaded MCU 'mcu' 132 commands (9d7a351 / gcc: (GCC) 7.3.0 binutils: (GNU Binutils) 2.26.20160125)
MCU 'mcu' config: ADC_MAX=1023 BUS_PINS_spi=PB3,PB2,PB1 BUS_PINS_twi=PD0,PD1 CLOCK_FREQ=16000000 MCU=atmega2560 PWM_MAX=255 RECEIVE_WINDOW=192 RESERVE_PINS_serial=PE0,PE1 SERIAL_BAUD=250000 STATS_SUMSQ_BASE=256 STEPPER_OPTIMIZED_UNSTEP=40 STEPPER_STEP_BOTH_EDGE=1
Sending MCU 'mcu' printer configuration...
Configured MCU 'mcu' (500 moves)
Running full garbage collection and freezing
Internal error on command:"G28"
Traceback (most recent call last):
  File "/app/klippy/gcode.py", line 212, in _process_commands
    handler(gcmd)
  File "/app/klippy/extras/homing.py", line 288, in cmd_G28
    kin.home(homing_state)
  File "/app/klippy/kinematics/delta.py", line 225, in home
    homing_state.home_rails(self.rails, forcepos, self.home_position)
  File "/app/klippy/extras/homing.py", line 201, in home_rails
    hmove.homing_move(homepos, hi.speed)
  File "/app/klippy/extras/homing.py", line 86, in homing_move
    self.stepper_positions = [ StepperPosition(s, name)
                               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/klippy/extras/homing.py", line 31, in __init__
    self.start_pos = stepper.get_mcu_position()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/klippy/stepper.py", line 170, in get_mcu_position
    return int(mcu_pos - 0.5)
           ^^^^^^^^^^^^^^^^^^
ValueError: cannot convert float NaN to integer
Transition to shutdown state: Internal error on command:"G28"
Dumping gcode input 1 blocks
Read 3779.638027: 'G28\nDELTA_CALIBRATE\n'
gcode state: absolute_coord=True absolute_extrude=True base_position=[0.0, 0.0, 0.0, 0.0] last_position=[-11.486506407542976, 4.1387278264288625, -433.8695293656721, 0.0] homing_position=[0.0, 0.0, 0.0, 0.0] speed_factor=0.016666666666666666 extrude_factor=1.0 speed=25.0
Reactor garbage collection: (0.0, 0.0, 0.0)
Internal error on command:"G28"
Once the underlying issue is corrected, use the
"FIRMWARE_RESTART" command to reset the firmware, reload the
config, and restart the host software.
Printer is shutdown

Internal error on command:"G28"
Internal error on command:"G28"
Once the underlying issue is corrected, use the
"FIRMWARE_RESTART" command to reset the firmware, reload the
config, and restart the host software.
Printer is shutdown

Unfreezing garbage collection
